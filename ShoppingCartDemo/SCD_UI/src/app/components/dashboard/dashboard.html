<div class="container-fluid py-4">
  <div class="row">
    <!-- Sidebar Filter -->
    <div class="col-md-3 mb-4">
      <div class="card shadow-sm">
        <div class="card-body">
          <h5 class="card-title"><i class="fa fa-filter me-2"></i>Filter</h5>
          <ul class="list-group">
            <li class="list-group-item d-flex justify-content-between align-items-center"
                [class.active]="selectedCategory === 'All'"
                (click)="filterCategory('All')"
                style="cursor: pointer;">
              All<span class="badge bg-primary rounded-pill">{{products.length}}</span>
            </li>
            <li class="list-group-item d-flex justify-content-between align-items-center"
                *ngFor="let cat of categories"
                [class.active]="selectedCategory === cat"
                (click)="filterCategory(cat)"
                style="cursor: pointer;">
              {{ cat  }}<span class="badge bg-secondary rounded-pill">{{getCategoryCount(cat)}}</span>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Product Listing -->
    <div class="col-md-9">
      <div class="row g-4">
        <div class="col-sm-6 col-lg-4"
             *ngFor="let product of paginatedProducts">
          <div class="card shadow-sm h-100">
            <img [src]="product.imageUrl"
                 class="card-img-top"
                 [alt]="product.name"
                 onerror="this.onerror=null; this.src='./assets/images/noimage.png';"
                 style="height: 200px; object-fit: cover;" />
            <div class="card-body d-flex flex-column">
              <h6 class="card-title">{{ product.name }}</h6>
              <p class="text-muted small mb-1">{{ product.category }}</p>
              <p class="fw-bold">â‚¹{{ product.price }}</p>
              <button *ngIf="!isAdmin" class="btn btn-sm btn-primary mt-auto"
                      (click)="addToCart(product)">
                <i class="fa fa-cart-plus me-2"></i>Add to Cart
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Pagination -->
      <nav class="mt-4" *ngIf="totalPages > 1">
        <ul class="pagination justify-content-center">
          <li class="page-item"
              [class.disabled]="currentPage === 1"
              (click)="changePage(currentPage - 1)">
            <a class="page-link" href="javascript:void(0)">&laquo;</a>
          </li>

          <li class="page-item"
              *ngFor="let page of [].constructor(totalPages); let i = index"
              [class.active]="currentPage === i + 1"
              (click)="changePage(i + 1)">
            <a class="page-link" href="javascript:void(0)">{{ i + 1 }}</a>
          </li>

          <li class="page-item"
              [class.disabled]="currentPage === totalPages"
              (click)="changePage(currentPage + 1)">
            <a class="page-link" href="javascript:void(0)">&raquo;</a>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</div>
